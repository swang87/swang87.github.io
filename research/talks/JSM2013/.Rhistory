install.packages("knitr")
install.packages("knitr")
install.packages("xtable")
library(strucchange)
?breakpoints
data("Nile")
plot(Nile)
## F statistics indicate one breakpoint
fs.nile <- Fstats(Nile ~ 1)
plot(fs.nile)
breakpoints(fs.nile)
Nile
head(Nile)
plot(Nile)
names(Nile)
Nile
bcp(Nile, 1:length(Nile))
library(bcp2)
bcp(Nile, 1:length(Nile))
bcp(as.numeric(Nile), 1:length(Nile))
bcp(as.numeric(Nile), 1:length(as.numeric(Nile)))
as.numeric(Nile)
a <- as.numeric(Nile)
args(bcp)
bcp(a, 1:length(a))
length(a)
a
log(a)
a <- log(a)
plot(a)
as.numeric(Nile)
bcp(a,1:length(a))
debug(bcp)
bcp(a,1:length(a))
ans
Q
bcp(a,1:length(a))
debug(worker.bcp)
debug(worker.bcp)
debug(worker.bcp)
out
?Nile
library(strucchange)
library(bcp2)
nile <- as.numeric(Nile)
plot(Nile, main="Nile River Flow (1871-1970)")
Q
library(strucchange)
library(bcp2)
nile <- as.numeric(Nile)
plot(Nile, main="Nile River Flow (1871-1970)")
library(strucchange)
library(bcp2)
nile <- as.numeric(Nile)
plot(Nile, main="Nile River Flow (1871-1970)")
## using BP
bp.nile <- breakpoints(Nile ~ 1)
summary(bp.nile)
## using BH-R
bhr.nile <- bcp(nile, 1:length(nile))
plot(bhr.nile)
Q
summary(bp.nile)
breakpoints(bp.nile)
names(Nile)
ts(Nile)
years(Nile)
Nile
years = 1871:1970
breakpoints(bp.nile)
bhr.nile
nile <- as.numeric(Nile)
bhr.nile <- bcp(nile, 1871:1970)
c
bcp.nile
bhr.nile
head(x)
x <- read.table("termite.txt", header=T)
data <- read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T)
## Dose (5mg)
y <- as.numeric(data[1:8,-1])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,x)
plot(term.model)
Q
data <- read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T)
head(data)
y <- as.numeric(data[1:8,-(1:2)])
data[1:8,-(1:2)]
y <- as.numeric(data[1:8,-(1:2)])
is.matrix(y)
is.matrix(data)
class(data)
data <- read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T)
data
data <- read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T)
class(data)
data <- as.matrix(data)
y <- as.numeric(data[1:8,-(1:2)])
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (5mg)
y <- as.numeric(data[1:8,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,x)
c
term.model
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (5mg)
y <- as.numeric(data[1:8,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,x)
plot(term.model)
x
y
head(data)
term.model
bcp
term.model
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (5mg)
y <- as.numeric(data[1:8,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,x)
plot(term.model)
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (5mg)
y <- as.numeric(data[1:8,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,x)
plot(term.model)
term.model
debug(bcp)
bcp(y,x)
debug(worker.bcp)
out
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (5mg)
y <- as.numeric(data[1:8,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,jitter(x))
plot(term.model)
Q
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (5mg)
y <- as.numeric(data[1:8,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,jitter(x))
plot(term.model)
Q
undebug()
undebug(bcp)
library(bcp2)
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (5mg)
y <- as.numeric(data[1:8,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,jitter(x))
plot(term.model)
plot(y~x)
data
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (10mg)
y <- as.numeric(data[9:16,-(1:2)])
x <- rep(1:15, each=8)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,jitter(x))
plot(term.model)
plot(y~x)
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (10mg)
y <- as.numeric(data[9:10,-(1:2)])
x <- rep(1:15, each=2)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,jitter(x))
plot(term.model)
plot(y~x)
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (10mg)
y <- as.numeric(data[11:16,-(1:2)])
x <- rep(1:15, each=6)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,jitter(x))
plot(term.model)
term.model$blocks
apply(term.model$mcmc.rhos, 1, max'')
apply(term.model$mcmc.rhos, 1, max)
head(term.model$mcmc.rhos)
term.model <- bcp(y,jitter(x), returnmcmc=T)
term.model <- bcp(y,jitter(x), return.mcmc=T)
plot(term.model)
dim(term.model$mcmc.rhos)
modalBlock <- function(parts) {
parts <- apply(parts, 2, function(x) paste(x, collapse=","))
tbl <- table(parts)
if (max(tbl) != 1) {
mode <- names(tbl)[which(tbl==max(tbl))]
mode <- strsplit(mode,",")
if (length(mode) > 1) {
print("More than 1 mode!")
return(mode)
} else {
return(unlist(mode))
}
}
}
if (length(x$mcmc.rhos) > 1) abline(v=which(modalBlock(x$mcmc.rhos)), col="red")
?grid.lines
x <- rnorm(200, sd=5)
y <- c(rnorm(100, -2+x[1:100], 0.1), rnorm(100, 1+x[101:200], 0.1))
plot(y~x)
x <- rnorm(200, sd=5)
y <- c(rnorm(100, -2+x[1:100], 5), rnorm(100, 1+x[101:200], 5))
plot(y~x)
y <- c(rnorm(100, -2+x[1:100], 3), rnorm(100, 1+x[101:200], 3))
plot(y~x)
y <- c(rnorm(100, -2+x[1:100], 1), rnorm(100, 1+x[101:200], 1))
plot(y~x)
res <- bcp(y, x)
plot(res)
y <- c(rnorm(100, -2+x[1:100], 1), rnorm(100, 1+x[101:200], 1), rnorm(5, 2*x[201:205],1))
x <- rnorm(205, sd=5)
y <- c(rnorm(100, -2+x[1:100], 1), rnorm(100, 1+x[101:200], 1), rnorm(5, 2*x[201:205],1))
res <- bcp(y, x)
plot(res)
library(bcp2)
data <- as.matrix(read.table("~/Dropbox/Files/Dissertation/termite.txt", header=T, as.is=T))
## Dose (10mg)
y <- colMeans(data[11:16,-(1:2)])
x <- rep(1:15)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,jitter(x), return.mcmc=T)
plot(term.model)
y <- colMeans(data[11:16,-(1:2)])
x <- rep(1:15)
x <- x[!is.na(y)]
y <- y[!is.na(y)]
term.model <- bcp(y,x, return.mcmc=T)
plot(term.model)
library(bcp2)
set.seed(19)
x <- rnorm(200)
y <- c(rnorm(100, 1-x[1:100], 0.1), rnorm(100, 1+x[101:200], 0.1))
res <- bcp(y, x)
plot(res)
library(bcp2)
set.seed(19)
x <- rnorm(200)
y <- c(rnorm(100, 1-x[1:100], 0.1), rnorm(100, 1+x[101:200], 0.1))
res <- bcp(y, x, return.mcmc=T)
plot(res)
source("~/Desktop/bcp-regression/bcp-plots.R")
plot2(res)
library(bcp2)
set.seed(19)
x <- rnorm(200)
y <- c(rnorm(100, 1-x[1:100], 0.1), rnorm(100, 1+x[101:200], 0.1))
res <- bcp(y, x, mcmc.return=T)
plot(res)
source("~/Desktop/bcp-regression/bcp-plots.R")
plot2(res)
?bcp
library(bcp2)
set.seed(19)
x <- rnorm(200)
y <- c(rnorm(100, 1-x[1:100], 0.1), rnorm(100, 1+x[101:200], 0.1))
res <- bcp(y, x, return.mcmc=T)
plot(res)
source("~/Desktop/bcp-regression/bcp-plots.R")
plot2(res)
res$mcmc.rho
plot(Res)
plot(res)
res$mcmc.rho
library(slidify)
setwd("~/Desktop/PPMGraph/JSM2013/")
ls
dir()
slidify(talk)
?slidify
slidify("talk.Rmd")
